<!DOCTYPE html>
<html lang="en">
<head>
  <title>Scoring Admin</title>
  <link rel="shortcut icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}" />
  <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='style.css')}}" />
  <script type=text/javascript src="{{url_for('static', filename='jquery.js') }}"></script>
<style>
  label {
    width: 10em;
    display: inline-block;
  }
  p {
    margin: 2px;
  }
  
  tr:target {
    background: #ffb;
  }
</style>
</head>
<body>
  <h1>Scoring Admin - Event Entries</h2>
  {% include "admin_nav.html" %}
  {% include "flash_message.html" %}

  <div>
    <h2>Add entry to current event</h2>
    <form action="{{url_for('entries_page')}}" method='POST'>
      <input type="hidden" name="event_id" value="{{g.active_event_id}}" />
      <p><label>Driver:</label>*<select name="driver_id" required>
        <option selected disabled>-- Select Driver --</option>
        {% for driver in g.driver_list %}
        <option value="{{driver.driver_id}}">{{driver.first_name}} {{'('+driver.alt_name+')' if driver.alt_name}} {{driver.last_name}} [{{driver.driver_id}}]</option>
        {% else %}
          <option disabled>None</option>
        {% endfor %}
      </select></p>
      <p><label>RFID #:</label>*<input type="number" min="0" max="9999999999" size=40 name="rfid_number" required /></p>
      <p><label>Dual Driver:</label> <select name="dual_driver">
        <option value="0" >No</option>
        <option value="1" >Yes</option>
      </select></p>
      <p><label>Car Year:</label> <input type="text" size=40 name="car_year" /></p>
      <p><label>Car Make:</label> <input type="text" size=40 name="car_make" /></p>
      <p><label>Car Model:</label> <input type="text" size=40 name="car_model" /></p>
      <p><label>Car Color:</label> <input type="text" size=40 name="car_color" /></p>
      <p><label>Car Number:</label>*<input type="number" min="0" max="1000" size=40 name="car_number" required /></p>

      <p><label>Car Class:</label>*<select name="car_class" required >
        <option selected disabled>-- Select Class --</option>
        {% for car_class in config.CAR_CLASSES %}
        <option value="{{car_class}}" >{{car_class}}: {{config.CAR_CLASS_NAMES[car_class]}}</option>
        {% else %}
        <option value="TO">TO: Time Only</option>
        {% endfor %}
      </select></p>
      <p><label>Season Points:</label> <select name="season_points">
        <option value="1" selected>Yes</option>
        <option value="0" >No</option>
      </select></p>
      <p><label>Work Assignment:</label> <input type="text" size=40 name="work_assign" /></p>
      <p><label>Show Scores:</label> <select name="show_scores">
        <option value="1" selected>Yes</option>
        <option value="0" >No</option>
      </select></p>
      <p><label>Note:</label> <input type="text" size=40 name="entry_note" /></p>
      <br/>
      <p><label><b>* = required</b></label> <button type="submit" name="action" value="insert">Add Entry</button></p>
    </form>
  </div>
  <hr/>
  <h2>Entry List</h2>
  <table class="simple tshrink">
    <tr>
      <th colspan=3 class="nowrap">Entry</th>
      <th class="nowrap">Car Class</th>
      <th class="nowrap">Car Number</th>
      <th class="nowrap">Driver</th>
      <th class="nowrap">RFID #</th>
      <th class="nowrap">Dual Driver</th>
      <th class="nowrap">Show Scores</th>
      <th class="nowrap">Note</th>
    </tr>
    <tr class="break"></tr>
    {% for entry in g.entry_driver_list %}
    <a name="{{entry.entry_id}}" />
    <tr id="{{entry.entry_id}}">
      <td><button onclick='$("#edit_{{entry.entry_id}}").toggle()'>Edit</button></td>
      <td>
        <form action="{{url_for('entries_page')}}" method="POST">
          <input type="hidden" name="entry_id" value="{{entry.entry_id}}">
          <button type="submit" value="print" name="action">Print</button>
        </form>
      </td>
      <td><b>[{{entry.entry_id}}]</b></td>
      <td>{{entry.car_class}}</td>
      <td>{{entry.car_number}}</td>
      <td class="nowrap">{{entry.first_name}} {{'('+entry.alt_name+')' if entry.alt_name}} {{entry.last_name}}</td>
      <td>{{entry.rfid_number}}</td>
      <td>{{'Yes' if entry.dual_driver else 'No'}}</td>
      <td>{{'Yes' if entry.show_scores else 'No'}}</td>
      <td style="text-align: left">{{entry.entry_note if entry.entry_note}}</td>
    </tr>
    <tr id="edit_{{entry.entry_id}}" style="display: none">
      <td colspan=10 style="text-align: left; background: #ffd">
        <form action="{{url_for('entries_page')}}" method='POST'>
          <input type="hidden" name="entry_id" value="{{entry.entry_id}}" />
          <p><label>Driver:</label>*<select name="driver_id" required>
            {% for driver in g.driver_list %}
            <option value="{{driver.driver_id}}" {{'selected' if entry.driver_id == driver.driver_id}}>{{driver.first_name}} {{'('+driver.alt_name+')' if driver.alt_name}} {{driver.last_name}} [{{driver.driver_id}}]</option>
            {% else %}
              <option disabled>None</option>
            {% endfor %}
          </select></p>
          <p><label>RFID #:</label>*<input type="number" min="0" max="9999999999" size=40 name="rfid_number" value="{{entry.rfid_number if entry.rfid_number}}" required /></p>
          <p><label>Dual Driver:</label> <select name="dual_driver">
            <option value="0" {{'selected' if not entry.dual_driver}}>No</option>
            <option value="1" {{'selected' if entry.dual_driver}}>Yes</option>
          </select></p>
          <p><label>Car Year:</label> <input type="text" size=40 name="car_year" value="{{entry.car_year if entry.car_year}}" /></p>
          <p><label>Car Make:</label> <input type="text" size=40 name="car_make" value="{{entry.car_make if entry.car_make}}" /></p>
          <p><label>Car Model:</label> <input type="text" size=40 name="car_model" value="{{entry.car_model if entry.car_model}}" /></p>
          <p><label>Car Color:</label> <input type="text" size=40 name="car_color" value="{{entry.car_color if entry.car_color}}" /></p>
          <p><label>Car Number:</label>*<input type="number" min="0" max="1000" size=40 name="car_number" value="{{entry.car_number if entry.car_number}}" required /></p>

          <p><label>Car Class:</label>*<select name="car_class" required >
            {% for car_class in config.CAR_CLASSES %}
            <option value="{{car_class}}" {{'selected' if entry.car_class == car_class}}>{{car_class}}: {{config.CAR_CLASS_NAMES[car_class]}}</option>
            {% else %}
            <option value="TO">TO: Time Only</option>
            {% endfor %}
          </select></p>
          <p><label>Season Points:</label> <select name="season_points">
            <option value="0" {{'selected' if not entry.season_points}}>No</option>
            <option value="1" {{'selected' if entry.season_points}}>Yes</option>
          </select></p>
          <p><label>Work Assignment:</label> <input type="text" size=40 name="work_assign" value="{{entry.work_assign if entry.work_assign}}"/></p>
          <p><label>Show Scores:</label> <select name="show_scores">
            <option value="0" {{'selected' if not entry.show_scores}}>No</option>
            <option value="1" {{'selected' if entry.show_scores}}>Yes</option>
          </select></p>
          <p><label>Note:</label> <input type="text" size=40 name="entry_note" value="{{entry.entry_note if entry.entry_note}}"/></p>
          <hr/>
          <button type="submit" name="action" value="update">Save Changes</button>
          <span style="float: right"> Confirm Delete:<input type="checkbox" name="confirm_delete" value="do_it"/> - <button type="submit" name="action" value="delete">Delete Entry</button></span>
        </form>
      </td>
    </tr>
    <tr class="break"></tr>
    {% else %}
    <tr><td colspan=11>None</td></tr>
    {% endfor %}
  </table>
</body>
</html>

